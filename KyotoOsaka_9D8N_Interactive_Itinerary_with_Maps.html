<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
<title>äº¬éƒ½ãƒ»å¤§é˜ªï½œ9å¤©8å¤œé¬†æ•£è¡Œç¨‹æ‰‹å†Šï¼ˆå« Google åœ°åœ–ï¼‰</title>
<meta name="description" content="å¯äº’å‹•çš„äº¬éƒ½ãƒ»å¤§é˜ª9å¤©8å¤œè¡Œç¨‹è¡¨ï¼‹æª¢æŸ¥æ¸…å–®ï¼Œå·²æ•´åˆ Google åœ°åœ–é€£çµã€äº¤é€šèˆ‡é¤å»³å»ºè­°ã€‚">
<style>
:root{
  --bg:#0b0c0f; --panel:#13151a; --text:#e9eef5; --muted:#a8b0bd; --brand:#7bd4ff;
  --accent:#79e2a7; --danger:#ff8a8a; --badge:#2a2f3a; --border:#2c3240; --shadow: 0 10px 30px rgba(0,0,0,.35);
}
*{box-sizing:border-box} html,body{height:100%}
body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Noto Sans TC","PingFang TC","Heiti TC",sans-serif;color:var(--text);background:radial-gradient(1200px 800px at 80% -10%, #102132, transparent 40%), var(--bg);line-height:1.55}
a{color:var(--brand);text-decoration:none} a:hover{text-decoration:underline}
.container{max-width:1080px;margin:0 auto;padding:20px}
.hero{position:relative;padding:28px 20px 18px;border-radius:16px;background:linear-gradient(160deg,#141a22,#0f1320 55%,#0b0e16);box-shadow:var(--shadow);overflow:hidden}
.hero h1{margin:0;font-size:clamp(22px,3.2vw,34px)} .hero p{margin:6px 0 0;color:var(--muted)}
.badges{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
.badge{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border-radius:999px;background:var(--badge);color:#cbd5e1;font-size:12px;border:1px solid var(--border)}
.controls{display:flex;gap:8px;flex-wrap:wrap;margin-top:12px}
.button{display:inline-flex;align-items:center;gap:8px;background:#101521;border:1px solid var(--border);color:var(--text);padding:10px 14px;border-radius:12px;cursor:pointer;transition:.2s}
.button:hover{filter:brightness(1.08)} .button.primary{background:linear-gradient(180deg,#1a2738,#162130);border-color:#253043}
.small{font-size:12px;color:var(--muted)}
.day-nav{position:sticky;top:0;z-index:30;backdrop-filter:blur(6px);background:rgba(10,13,18,.7);border-bottom:1px solid var(--border)}
.day-tabs{display:flex;overflow:auto;gap:8px;padding:8px 10px}
.day-tabs a{flex:0 0 auto;padding:8px 12px;border:1px solid var(--border);border-radius:999px;color:#cfe7ff;background:#0f1420;font-weight:600;font-size:13px;white-space:nowrap}
.day-tabs a.active{background:linear-gradient(180deg,#15304a,#12253a);color:#fff}
.section{margin:18px 0 26px}
.card{background:linear-gradient(180deg,#10141c,#0d121a);border:1px solid var(--border);border-radius:14px;padding:16px;box-shadow:var(--shadow)}
.grid{display:grid;gap:16px} @media(min-width:900px){ .grid{grid-template-columns:1.1fr .9fr} }
.day{border:1px solid var(--border);border-radius:16px;overflow:hidden}
.day summary{list-style:none;cursor:pointer;padding:14px 16px;background:linear-gradient(180deg,#0e1420,#0b1018);border-bottom:1px solid var(--border);display:flex;align-items:center;gap:10px}
.day summary::-webkit-details-marker{display:none}
.day h3{margin:0;font-size:clamp(16px,2.2vw,20px)} .meta{color:var(--muted);font-size:13px}
.timeline{padding:10px 14px}
.item{display:grid;grid-template-columns:90px 1fr;gap:10px;padding:10px 6px;border-bottom:1px dashed #2a3240}
.item:last-child{border-bottom:none}
.time{color:#d0d9e8;font-weight:600}
.what strong{font-weight:800}
.tag{display:inline-block;margin-left:6px;padding:2px 8px;border-radius:999px;background:#1a2434;color:#d3e8ff;border:1px solid #27364a;font-size:12px}
.note{color:var(--muted);font-size:13px;margin-top:4px}
.flex{display:flex;gap:8px;flex-wrap:wrap;margin-top:6px}
.map-btn{display:inline-flex;gap:6px;align-items:center;padding:6px 10px;border:1px solid var(--border);border-radius:8px;background:#0f1420;cursor:pointer;font-size:13px}
.map-btn:hover{filter:brightness(1.05)} .map-btn .pin{font-size:14px}
.checklist{display:grid;gap:6px;margin-top:8px}
.check{display:flex;gap:10px;align-items:flex-start;padding:10px 12px;background:#0f1420;border:1px solid var(--border);border-radius:12px}
.check input{width:18px;height:18px;margin-top:2px} .check label{flex:1} .check .mini{display:block;color:var(--muted);font-size:12px}
.table{width:100%;border-collapse:collapse;margin-top:6px;font-size:14px}
.table th,.table td{padding:10px;border-bottom:1px solid var(--border);text-align:left;vertical-align:top}
.footer{color:var(--muted);text-align:center;margin:20px 0 40px}
.notice{padding:10px 12px;border:1px dashed var(--border);border-radius:10px;background:rgba(123,212,255,.06)}
:root.light{--bg:#f5f7fb;--panel:#fff;--text:#0b0f16;--muted:#506079;--badge:#f0f4fb;--border:#e2e8f0;--brand:#0b6bcb;--accent:#178f66;--danger:#d23b3b;--shadow:0 10px 25px rgba(10,14,27,.08)}
:root.light body{background:#f2f6fc} :root.light .map-btn{background:#fff}
.kicker{font-weight:700;color:#9ac7ff;text-transform:uppercase;letter-spacing:.12em;font-size:12px}
hr.sep{border:none;border-top:1px dashed var(--border);margin:16px 0}
</style>
</head>
<body>
<div class="day-nav"><div class="day-tabs" id="dayTabs"></div></div>
<div class="container">
  <header class="hero">
    <div class="kicker">äº¬éƒ½ãƒ»å¤§é˜ªï½œ2025/11/16â€“11/24ï¼ˆ9å¤©8å¤œï¼‰</div>
    <h1>é¬†æ•£ã€é †æš¢ã€å¿«æ¨‚æ„Ÿå„ªå…ˆçš„æ—…è¡Œæ‰‹å†Šï¼ˆå« Google åœ°åœ–ï¼‰</h1>
    <p>ä½å®¿ï¼šå››æ¡æ²³åŸç”º â†’ æ±å¯ºï¼ˆè¿‘äº¬éƒ½ç«™ï¼‰ â†’ JRé›£æ³¢/OCAT â†’ è‡¨ç©ºåŸï¼ˆRinku Townï¼‰ã€‚USJ 11/20ã€teamLab 11/21 09:30ã€‚</p>
    <div class="badges"><span class="badge">è³æ¥“ä¸»è»¸</span><span class="badge">å°‘è½‰ä¹˜</span><span class="badge">å–®äººå‹å–„é¤å»³</span><span class="badge">å·²é™„åœ°åœ–</span></div>
    <div class="controls">
      <button class="button" id="toggleTheme">åˆ‡æ›æ·±/æ·ºè‰²</button>
      <button class="button" onclick="window.print()">åˆ—å° / å­˜ PDF</button>
      <button class="button primary" id="expandAll">å±•é–‹å…¨éƒ¨</button>
      <button class="button" id="collapseAll">å…¨éƒ¨æ”¶åˆ</button>
    </div>
    <div class="small">æç¤ºï¼šæœ¬é å‹¾é¸æœƒä¿å­˜åœ¨ä½ çš„è£ç½®ã€‚æ‰€æœ‰ã€ŒğŸ—º é–‹åœ°åœ–ã€æŒ‰éˆ•æœƒç›´æ¥é–‹å•Ÿ Google åœ°åœ– App æˆ–ç¶²é ã€‚</div>
  </header>

  <section class="section grid">
    <div class="card">
      <h3>ç¥¨åˆ¸èˆ‡äº¤é€šï¼ˆç²¾ç°¡ï¼‰</h3>
      <table class="table">
        <tr><th>å ´æ™¯</th><th>å»ºè­°</th></tr>
        <tr><td>KIX â†’ äº¬éƒ½ï¼ˆ11/16ï¼‰</td><td>JR <b>HARUKA</b> æŒ‡å®šå¸­ â†’ äº¬éƒ½ç«™ï¼Œå†çš„å£«/é˜ªæ€¥åˆ°å››æ¡æ²³åŸç”ºã€‚</td></tr>
        <tr><td>äº¬éƒ½å¸‚å…§</td><td>ä»¥ <b>ICOCA</b>ï¼ˆå« Mobile ICOCAï¼‰æ­åœ°éµ/ç§éµï¼›å¯†é›†ç§»å‹•æ—¥é¸ã€Œåœ°ä¸‹éµï¼‹å·´å£«ä¸€æ—¥åˆ¸ã€ã€‚</td></tr>
        <tr><td>å¤§é˜ªå¸‚å…§ï¼ˆ11/23ï¼‰</td><td>è¦–éœ€æ±‚è³¼ <b>Osaka Metro Enjoy Eco Card</b> ä¸€æ—¥åˆ¸ã€‚</td></tr>
        <tr><td>å¤§é˜ª â†’ è‡¨ç©ºåŸï¼ˆ11/23 å¤œï¼‰</td><td>å—æµ·é›»éµ Rapi:t æˆ– æ©Ÿå ´æ€¥è¡Œï¼Œè‡³ <b>Rinku Town</b>ã€‚</td></tr>
        <tr><td>è‡¨ç©ºåŸ â†’ KIXï¼ˆ11/24ï¼‰</td><td>å—æµ·ä¸€ç«™ç›´é” KIXï¼Œé ç•™ 2 å°æ™‚ã€‚</td></tr>
      </table>
      <div class="notice">è»Šè³‡/æ™‚åˆ»ä»¥å®˜æ–¹å…¬å‘Šç‚ºæº–ã€‚æ­¤æ‰‹å†Šä»¥ã€Œå°‘è½‰ä¹˜ã€å°‘æ’éšŠã€é«”åŠ›å‹å–„ã€ç‚ºåŸå‰‡ã€‚</div>
    </div>
    <div class="card">
      <h3>é«˜ç´šé¤å»³ï¼ˆâ‰¤ Â¥20,000ï¼äººï¼Œå–®äººOKï¼‰</h3>
      <ul>
        <li>ç¥‡åœ’ ãªã‚“æ³¢ï¼ˆå‰²çƒ¹æœƒå¸­ï¼‰</li>
        <li>å…«å‚åœ“å ‚ï¼ˆå¤©å©¦ç¾…ï¼‰</li>
        <li>å»£å·ï¼ˆåµå±±ãƒ»é°»é­šï¼‰</li>
        <li>éµæ¿ç‡’ KOBEï¼ˆMonterey 22F, å¤§é˜ªï¼‰</li>
      </ul>
      <div class="small">é¤å»³åç¨±å·²å¯ç›´æ¥é»ã€ŒğŸ—º é–‹åœ°åœ–ã€ï¼Œä¹Ÿå¯ä¾ <b>å®šä½</b> æŒ‰éˆ•é–‹å•Ÿå°±è¿‘æœå°‹ã€‚</div>
    </div>
  </section>

  <section class="section">
    <h3>æ¯æ—¥è¡Œç¨‹è¡¨ï¼ˆå¯å‹¾é¸ã€å«åœ°åœ–ï¼‰</h3>
    <div id="days"></div>
  </section>

  <section class="section card">
    <h3>å¿«é€Ÿåœ°åœ–ç´¢å¼•</h3>
    <div id="mapIndex" class="flex"></div>
  </section>

  <footer class="footer">ç‰ˆæœ¬ï¼š2025/11/15ï¼ˆå«åœ°åœ–ï¼‰ â€¢ å»ºè­°å°‡æœ¬é åŠ å…¥æ‰‹æ©Ÿä¸»ç•«é¢ â€¢ è¨­è¨ˆï¼šä½ çš„æ—¥æœ¬å°éŠå¤¥ä¼´</footer>
</div>

<script>
const LSKEY = "kyoto-osaka-2025-state-v2-map";
const $ = (q,root=document)=>root.querySelector(q);
const $$ = (q,root=document)=>Array.from(root.querySelectorAll(q));

// --- Google Maps helpers ---
function gmSearchLink(q){ return "https://www.google.com/maps/search/?api=1&query="+encodeURIComponent(q); }
function gmPlaceLink(urlOrQuery){ return urlOrQuery.startsWith("http") ? urlOrQuery : gmSearchLink(urlOrQuery); }

// Common places (ç²¾æº–URLå„ªå…ˆï¼Œå¦å‰‡ç”¨æŸ¥è©¢)
const PLACES = {
  // ä½å®¿ / äº¤é€šæ¨ç´
  "KIX": "Kansai International Airport Terminal 1",
  "äº¬éƒ½ç«™": "Kyoto Station",
  "Travelodge Kyoto Shijo Kawaramachi": "Travelodge Kyoto Shijo Kawaramachi",
  "Loisir Kyoto Toji": "Loisir Hotel Kyoto Toji",
  "Monterey Grasmere Osaka": "Hotel Monterey Grasmere Osaka",
  "OMO Kansai Airport": "OMO Kansai Airport by Hoshino Resorts",
  "JRé›£æ³¢/OCAT": "JR Namba Station OCAT",
  "Rinku Town": "Rinku Town Station",

  // å¿…è¨ªæ™¯é»ï¼ˆç›¡é‡ä½¿ç”¨ç²¾æº–é€£çµï¼Œä¾†æºï¼šä½ çš„æŒ‡å—èˆ‡å¸¸ç”¨åœ°æ¨™ï¼‰
  "æ±ç¦å¯º": "Tofuku-ji Temple Kyoto",
  "æ³‰æ¶Œå¯º": "Sennyu-ji Temple Kyoto",
  "ä»Šç†Šé‡è§€éŸ³å¯º": "Imakumano Kannon-ji",
  "å“²å­¸ä¹‹é“": "Philosopher's Path Kyoto",
  "æ°¸è§€å ‚": "https://maps.app.goo.gl/txiwFqj5HMZnF7Zr6",
  "å—ç¦ªå¯º": "https://maps.app.goo.gl/64EWrb8nN1sDeC3g7",
  "å¤©é¾å¯º": "https://maps.app.goo.gl/NUjjjf7DXeXJXAJg7",
  "å¸¸å¯‚å…‰å¯º": "https://maps.app.goo.gl/MrZijBUJxmLDB6FJ6",
  "äºŒå°Šé™¢": "https://goo.gl/maps/rzBwVvkeDKJ4PWpTA",
  "åµå±±ç«¹æ—": "Arashiyama Bamboo Grove",
  "æ¸¡æœˆæ©‹": "Togetsukyo Bridge",
  "æ±å¯º": "To-ji Temple Kyoto",
  "æ¢…å°è·¯å…¬åœ’": "Umekoji Park",
  "äº¬éƒ½éµé“åšç‰©é¤¨": "Kyoto Railway Museum",
  "æ¸…æ°´å¯º": "Kiyomizu-dera Temple",
  // å¤§é˜ª / å…¶ä»–
  "USJ": "Universal Studios Japan",
  "å¿ƒé½‹æ©‹": "Shinsaibashi",
  "é“é “å €": "Dotonbori",
  "å €æ±Ÿ": "Horie Osaka",
  "å¤§é˜ªåŸ": "Osaka Castle",
  "å¤©æ»¿å•†åº—è¡—": "Tenma Shopping Street",
  "ä¸­ä¹‹å³¶": "Nakanoshima Park",
  "æ–°ä¸–ç•Œ": "Shinsekai",
  "é»‘é–€å¸‚å ´": "Kuromon Ichiba Market",
  "å—æµ·é›£æ³¢ç«™": "Nankai Namba Station",
  // teamLab
  "teamLab Kyoto": "ãƒãƒ¼ãƒ ãƒ©ãƒœ ãƒã‚¤ã‚ªãƒ´ã‚©ãƒ«ãƒ†ãƒƒã‚¯ã‚¹ äº¬éƒ½",
  // é¤å»³
  "ç¥‡åœ’ãªã‚“æ³¢": "Gion Nanba",
  "å…«å‚åœ“å ‚": "Tempura Endo Yasaka Main",
  "å»£å·": "Hirokawa Unagi Arashiyama",
  "Teppan KOBE": "Teppanyaki KOBE Monterey Grasmere"
};

// --- Trip data with location keys ---
const trip = {
  days: [
    {
      id:"D1", date:"11/16ï¼ˆæ—¥ï¼‰", title:"æŠµé”é—œè¥¿æ©Ÿå ´ â†’ äº¬éƒ½ï¼ˆå››æ¡æ²³åŸç”ºï¼‰",
      summary:"KIX æŠµé”ï¼ŒHARUKA é€²äº¬éƒ½ï¼ŒéŒ¦å¸‚å ´/æ²³åŸç”ºè¼•é¬†èµ°ã€‚",
      tasks:[
        {time:"11:00", what:"æŠµé” KIX", tag:"äº¤é€š", loc:"KIX"},
        {time:"12:20â€“13:40", what:"JR HARUKA â†’ äº¬éƒ½ç«™", tag:"äº¤é€š", loc:"äº¬éƒ½ç«™"},
        {time:"14:10", what:"å…¥ä½/å¯„æ”¾ï¼šTravelodge Kyoto Shijo Kawaramachi", tag:"ä½å®¿", loc:"Travelodge Kyoto Shijo Kawaramachi"},
        {time:"14:30â€“17:00", what:"éŒ¦å¸‚å ´ & æ²³åŸç”ºæ•£æ­¥", tag:"æ•£æ­¥", loc:"Travelodge Kyoto Shijo Kawaramachi"},
        {time:"æ™šé¤", what:"æœ¬å®¶å°¾å¼µå±‹ï¼é™„è¿‘æ‹‰éºµ", tag:"é¤é£Ÿ", loc:"Travelodge Kyoto Shijo Kawaramachi"}
      ],
      checklist:["ICOCA å„²å€¼","æ—…é¤¨å…¥ä½æˆ–å¯„æ”¾è¡Œæ","æ—©ç¡é¤Šç²¾è“„éŠ³"]
    },
    {
      id:"D2", date:"11/17ï¼ˆä¸€ï¼‰", title:"æ±ç¦å¯º â†’ æ³‰æ¶Œå¯ºä¸€å¸¶ â†’ å“²å­¸ä¹‹é“ â†’ æ°¸è§€å ‚/å—ç¦ªå¯º",
      summary:"æ—©æ®µæ”»æ±ç¦å¯ºï¼Œä¸‹åˆå“²å­¸ä¹‹é“ä¸²æ°¸è§€å ‚ã€å—ç¦ªå¯ºã€‚",
      tasks:[
        {time:"08:00â€“10:00", what:"æ±ç¦å¯ºï¼ˆé€šå¤©æ©‹/è‡¥é›²æ©‹ï¼‰", tag:"è³æ¥“", loc:"æ±ç¦å¯º"},
        {time:"10:15â€“11:00", what:"æ³‰æ¶Œå¯ºä¸€å¸¶ï¼ˆé›²é¾é™¢/ä»Šç†Šé‡è§€éŸ³å¯ºï¼‰", tag:"è³æ¥“", loc:"æ³‰æ¶Œå¯º"},
        {time:"11:45â€“13:00", what:"ã€ˆé«˜ç´š#1ã€‰ç¥‡åœ’ãªã‚“æ³¢ åˆé¤ï¼ˆå‰²çƒ¹ï¼‰", tag:"é¤é£Ÿ", loc:"ç¥‡åœ’ãªã‚“æ³¢"},
        {time:"13:30â€“15:00", what:"å“²å­¸ä¹‹é“ â†’ æ°¸è§€å ‚", tag:"è³æ¥“", loc:"æ°¸è§€å ‚"},
        {time:"15:10â€“16:30", what:"å—ç¦ªå¯º & æ°´è·¯é–£", tag:"è³æ¥“", loc:"å—ç¦ªå¯º"},
        {time:"æ™šé¤", what:"ãŠã‚ã‚“ é«˜å°å¯ºï¼GOGYO äº¬éƒ½", tag:"é¤é£Ÿ", loc:"ç¥‡åœ’ãªã‚“æ³¢"}
      ],
      checklist:["07:20 å‡ºé–€","é¤å»³é ç´„ç¢ºèª","ç›¸æ©Ÿã€è¡Œå‹•é›»æº"]
    },
    {
      id:"D3", date:"11/18ï¼ˆäºŒï¼‰", title:"åµå±±æ…¢è¡Œï¼šç«¹æ— â†’ å¤©é¾å¯º â†’ å¸¸å¯‚å…‰å¯º/äºŒå°Šé™¢",
      summary:"æ—©æ®µç«¹æ—é¿äººï¼›åˆé¤åµå±±é°»é­šï¼›åˆå¾Œçœ‹å°ç«è»Šé¤˜ç¥¨ã€‚",
      tasks:[
        {time:"07:40â€“08:30", what:"åµå±±ç«¹æ—", tag:"è³æ¥“", loc:"åµå±±ç«¹æ—"},
        {time:"08:40â€“10:00", what:"å¤©é¾å¯ºï¼ˆæ›¹æºæ± ï¼‰", tag:"è³æ¥“", loc:"å¤©é¾å¯º"},
        {time:"10:20â€“11:20", what:"å¸¸å¯‚å…‰å¯º â†’ äºŒå°Šé™¢", tag:"è³æ¥“", loc:"å¸¸å¯‚å…‰å¯º"},
        {time:"11:45â€“13:00", what:"ã€ˆé«˜ç´š#2ã€‰å»£å· é°»é­š åˆé¤", tag:"é¤é£Ÿ", loc:"å»£å·"},
        {time:"16:00â€“17:30", what:"æ¸¡æœˆæ©‹æ²³å²¸æ•£æ­¥ & å’–å•¡", tag:"æ•£æ­¥", loc:"æ¸¡æœˆæ©‹"}
      ],
      checklist:["07:10 å‡ºç™¼åˆ°åµå±±","å»£å·å€™ä½/é ç´„ç¢¼","å°ç«è»Šçœ‹ç•¶æ—¥é¤˜ç¥¨"]
    },
    {
      id:"D4", date:"11/19ï¼ˆä¸‰ï¼‰", title:"æ›é£¯åº—è‡³æ±å¯ºæ—ï¼ˆLoisirï¼‰ï¼‹æ±å¯ºèˆ‡æ¢…å°è·¯å‘¨é‚Š",
      summary:"æ›æˆ¿æ—¥æ”¾é¬†ï¼›è¿‘è·é›¢é€›æ±å¯ºã€æ¢…å°è·¯ã€‚",
      tasks:[
        {time:"ä¸Šåˆ", what:"é€€æˆ¿ â†’ å‰å¾€ Loisir äº¬éƒ½æ±å¯ºï¼ˆå¯„æ”¾è¡Œæï¼‰", tag:"äº¤é€š", loc:"Loisir Kyoto Toji"},
        {time:"10:30â€“12:00", what:"æ±å¯ºï¼ˆäº”é‡å¡”åº­åœ’ï¼‰", tag:"è³æ¥“", loc:"æ±å¯º"},
        {time:"åˆå¾Œ", what:"æ¢…å°è·¯å…¬åœ’ï¼äº¬éƒ½éµé“åšç‰©é¤¨", tag:"æ•£æ­¥", loc:"æ¢…å°è·¯å…¬åœ’"},
        {time:"æ™šé¤", what:"ã€ˆé«˜ç´š#3 å€™é¸ã€‰å…«å‚åœ“å ‚ï¼ˆå¤©å©¦ç¾…ï¼‰", tag:"é¤é£Ÿ", loc:"å…«å‚åœ“å ‚"}
      ],
      checklist:["æ‰“åŒ…è¡Œæ","ç¢ºèªå…¥ä½/å¯„æ”¾è¦å‰‡","æ™šé¤å¦‚æœªè¨‚åˆ°æ”¹ä¸­åƒ¹"]
    },
    {
      id:"D5", date:"11/20ï¼ˆå››ï¼‰", title:"USJ ä¸€æ•´å¤©",
      summary:"App å…ˆæŠ½ SNW æ•´ç†åˆ¸ï¼›ä¾ App ç­‰å€™å½ˆæ€§å®‰æ’ã€‚",
      tasks:[
        {time:"06:50â€“07:10", what:"äº¬éƒ½ç«™å‡ºç™¼ â†’ ç´„ 08:00 æŠµ USJ", tag:"äº¤é€š", loc:"USJ"},
        {time:"å…¥åœ’å¾Œ", what:"æŠ½ Super Nintendo Worldã€Œå€åŸŸæ•´ç†åˆ¸ã€", tag:"é‡é»", loc:"USJ"},
        {time:"ç™½å¤©", what:"åœ’å€éŠç©", tag:"é«”é©—", loc:"USJ"},
        {time:"æ™šé¤", what:"å›äº¬éƒ½ç«™å‘¨é‚Šç°¡å–®åƒ/ä¼‘æ¯", tag:"é¤é£Ÿ", loc:"äº¬éƒ½ç«™"}
      ],
      checklist:["App ç¶å®šé–€ç¥¨","è¡Œå‹•é›»æº/é›¨å…·","å›ç¨‹è»Šæ¬¡ç¢ºèª"]
    },
    {
      id:"D6", date:"11/21ï¼ˆäº”ï¼‰", title:"teamLab 09:30â€“14:00 â†’ å‚æ™šå¤œæ¥“æˆ–ä¼‘æ¯",
      summary:"æ²‰æµ¸å±•ï¼‹å›é£¯åº—ä¼‘æ¯ï¼›æ™šé–“è¦–é«”åŠ›å®‰æ’å¤œæ¥“ã€‚",
      tasks:[
        {time:"09:10", what:"æŠµé”å ´é¤¨ï¼ˆäº¬éƒ½ç«™å…«æ¢æ±å£æ­¥è¡Œåœˆï¼‰", tag:"äº¤é€š", loc:"teamLab Kyoto"},
        {time:"09:30â€“14:00", what:"teamLab Biovortex Kyoto", tag:"é«”é©—", loc:"teamLab Kyoto"},
        {time:"å‚æ™š", what:"æ¸…æ°´å¯ºå¤œæ¥“ï¼ˆå½ˆæ€§ï¼‰æˆ–ä¼‘æ¯", tag:"å½ˆæ€§", loc:"æ¸…æ°´å¯º"}
      ],
      checklist:["ç¥¨åˆ¸QR 09:30 æª¢æŸ¥","ç›¸æ©Ÿé›»é‡","å¯å…ˆå›é£¯åº—åˆä¼‘"]
    },
    {
      id:"D7", date:"11/22ï¼ˆå…­ï¼‰", title:"äº¬éƒ½ â†’ å¤§é˜ªï¼ˆJRé›£æ³¢/OCATï¼‰å…¥ä½ Monterey Grasmere",
      summary:"ç§»å‹•æ—¥ï¼›ä¸‹åˆå¿ƒé½‹æ©‹/é“é “å €ï¼›æ™šé¤éµæ¿ç‡’ã€‚",
      tasks:[
        {time:"ä¸Šåˆ", what:"JR äº¬éƒ½ â†’ å¤§é˜ª â†’ ä»Šå®® â†’ JR é›£æ³¢ï¼ˆOCATï¼‰", tag:"äº¤é€š", loc:"JRé›£æ³¢/OCAT"},
        {time:"ä¸‹åˆ", what:"å¿ƒé½‹æ©‹ â†’ é“é “å € â†’ å €æ±Ÿï¼ˆæ“‡ä¸€ï½å…©å€ï¼‰", tag:"æ•£æ­¥", loc:"å¿ƒé½‹æ©‹"},
        {time:"æ™šé¤", what:"ã€ˆé«˜ç´š#4ã€‰Monterey 22F Teppanyaki KOBE", tag:"é¤é£Ÿ", loc:"Teppan KOBE"},
        {time:"ä½å®¿", what:"Hotel Monterey Grasmere Osaka", tag:"ä½å®¿", loc:"Monterey Grasmere Osaka"}
      ],
      checklist:["é€€æˆ¿/å¯„æ”¾/äº¤é€šå¡","ä»Šæ™šé¤å»³ç¢ºèª","å‚™ç”¨é›¨å…·/ä¿æš–"]
    },
    {
      id:"D8", date:"11/23ï¼ˆæ—¥ï¼‰", title:"å¤§é˜ªå¸‚å€è§€å…‰ â†’ å¤œæŠµè‡¨ç©ºåŸ OMO",
      summary:"å¯„æ”¾è¡Œæâ†’åŸå¸‚æ•£æ­¥â†’æ™šä¸Šå—æµ·åˆ° Rinku Townã€‚",
      tasks:[
        {time:"ä¸Šåˆ", what:"é£¯åº—å¯„æ”¾è¡Œæï¼Œèµ·æ­¥é€›åŸå…§", tag:"å°å®åš€", loc:"Monterey Grasmere Osaka"},
        {time:"ç™½å¤©", what:"è·¯ç·šAï¼šå¤§é˜ªåŸâ†’å¤©æ»¿å•†åº—è¡—â†’ä¸­ä¹‹å³¶ï¼›æˆ– è·¯ç·šBï¼šæ–°ä¸–ç•Œâ†’é»‘é–€å¸‚å ´â†’é›£æ³¢", tag:"æ•£æ­¥", loc:"å¤§é˜ªåŸ"},
        {time:"18:30 å‰", what:"å—æµ· é›£æ³¢ â†’ Rinku Town â†’ å…¥ä½ OMO", tag:"äº¤é€š", loc:"å—æµ·é›£æ³¢ç«™"},
        {time:"ä½å®¿", what:"OMO Kansai Airport by æ˜Ÿé‡é›†åœ˜", tag:"ä½å®¿", loc:"OMO Kansai Airport"}
      ],
      checklist:["17:30 å›é£¯åº—å–è¡Œæ","æº–å‚™å‡ºå¢ƒæ–‡ä»¶","æ‰‹æ©Ÿ/ç›¸æ©Ÿå……é›»"]
    },
    {
      id:"D9", date:"11/24ï¼ˆä¸€ï¼‰", title:"è‡¨ç©ºåŸ â†’ KIXï¼ˆ12:00 èµ·é£›ï¼‰",
      summary:"æœ€å¾Œä¸€å¤©è¼•é¬†å‡ºåœ‹ã€‚",
      tasks:[
        {time:"09:30", what:"é€€æˆ¿ â†’ å—æµ·ä¸€ç«™åˆ° KIX", tag:"äº¤é€š", loc:"KIX"},
        {time:"10:00â€“10:15", what:"è¾¦ç†è¡Œææ‰˜é‹ã€å‡ºå¢ƒå®‰æª¢", tag:"æ‰‹çºŒ", loc:"KIX"}
      ],
      checklist:["è­·ç…§/ç™»æ©Ÿè­‰","éš¨èº«æ¶²é«”è¦ç¯„","å…ç¨…å“æ”¶å¦¥"]
    }
  ]
};

// --- Renderers ---
function renderDays(){
  const tabs = $("#dayTabs"); tabs.innerHTML = "";
  const wrap = $("#days"); wrap.innerHTML = "";
  trip.days.forEach((d, idx)=>{
    const tab = document.createElement("a");
    tab.href = "#"+d.id; tab.textContent = `${d.id} ${d.date}`; tab.dataset.id=d.id;
    tab.className="tab"; tabs.appendChild(tab);

    const det = document.createElement("details"); det.className="day"; det.id=d.id;
    if(idx<=1) det.open = true;
    const sum = document.createElement("summary");
    sum.innerHTML = `<h3>${d.date}ï½œ${d.title}</h3><div class="meta">${d.summary}</div>`;
    det.appendChild(sum);

    const tl = document.createElement("div"); tl.className="timeline";
    d.tasks.forEach(t=>{
      const row = document.createElement("div"); row.className="item";
      const mapUrl = t.loc ? gmPlaceLink(PLACES[t.loc]||t.loc) : null;
      row.innerHTML = `
        <div class="time">${t.time}</div>
        <div class="what">
          <strong>${t.what}</strong> ${t.tag ? `<span class="tag">${t.tag}</span>`:""}
          ${t.note? `<div class="note">${t.note}</div>`:""}
          ${mapUrl? `<div class="flex"><a class="map-btn" href="${mapUrl}" target="_blank" rel="noopener"><span class="pin">ğŸ—º</span>é–‹åœ°åœ–</a><a class="map-btn" href="${gmSearchLink(t.what.replace(/[ã€ˆã€‰]/g,''))}" target="_blank" rel="noopener">ä»¥åç¨±æœå°‹</a></div>`:""}
        </div>`;
      tl.appendChild(row);
    });

    if(d.checklist?.length){
      tl.appendChild(document.createElement("hr")).className = "sep";
      const checkWrap = document.createElement("div"); checkWrap.className="checklist";
      d.checklist.forEach((c,i)=>{
        const id = `chk-${d.id}-${i}`;
        const checked = localStorage.getItem(LSKEY+"-"+id)==="1";
        const div = document.createElement("div"); div.className="check";
        div.innerHTML = `<input type="checkbox" id="${id}" ${checked?"checked":""}><label for="${id}">${c}</label>`;
        checkWrap.appendChild(div);
      });
      tl.appendChild(checkWrap);
    }

    det.appendChild(tl); wrap.appendChild(det);

    det.addEventListener("toggle", ()=>{ /* just visual highlight via hash change */ });
  });

  // checkbox persistence
  document.addEventListener("change",(e)=>{
    if(e.target.matches("input[type=checkbox]")){
      localStorage.setItem(LSKEY+"-"+e.target.id, e.target.checked?"1":"0");
    }
  });
  highlightActiveTab();
  window.addEventListener("hashchange", highlightActiveTab);
}

function highlightActiveTab(){
  const hash = location.hash.replace("#","");
  const tabs = $$("#dayTabs a"); tabs.forEach(t=>t.classList.remove("active"));
  const active = tabs.find(t=>t.dataset.id===hash) ?? tabs[0];
  if(active) active.classList.add("active");
}

// Build a flat map index for quick access
function renderMapIndex(){
  const cont = $("#mapIndex"); cont.innerHTML = "";
  Object.keys(PLACES).forEach(k=>{
    const a = document.createElement("a");
    a.className="map-btn"; a.href = gmPlaceLink(PLACES[k]||k); a.target="_blank"; a.rel="noopener";
    a.innerHTML = `<span class="pin">ğŸ“</span>${k}`;
    cont.appendChild(a);
  });
}

// UI buttons
$("#expandAll").addEventListener("click", ()=> $$("#days details").forEach(d=>d.open=true));
$("#collapseAll").addEventListener("click", ()=> $$("#days details").forEach(d=>d.open=false));
$("#toggleTheme").addEventListener("click", ()=> document.documentElement.classList.toggle("light"));

// init
renderDays();
renderMapIndex();
</script>
</body>
</html>
